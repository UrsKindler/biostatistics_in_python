# Post-Hoc Tests

### Overview
- **Purpose**: Identify which specific groups differ after significant ANOVA/Kruskal-Wallis
- **Use Case**: Multiple pairwise comparisons with Type I error control
- **Prerequisites**: Significant omnibus test (ANOVA p < 0.05 or Kruskal-Wallis p < 0.05)
- **Data Types**: Continuous or ordinal data with 3+ groups

### When to Use
#### Decision Criteria
- **Use always**: After significant ANOVA or Kruskal-Wallis test
- **Essential when**: Need to know which specific pairs differ
- **Don't use when**: Omnibus test not significant (p â‰¥ 0.05)
- **Choose method**: Based on variance equality and sample size

#### Data Type Requirements
- **After ANOVA**: Continuous numeric data, 3+ groups
- **After Kruskal-Wallis**: Ordinal or non-normal continuous data
- **Sample Size**: Minimum 3 observations per group
- **Not Suitable For**: 2 groups only, non-significant omnibus test

### R vs Python

| Aspect | R | Python |
|--------|---|--------|
| Package | `stats`, `multcomp`, `FSA` | `statsmodels`, `scikit_posthocs` |
| Tukey HSD | `TukeyHSD(aov_model)` | `pairwise_tukeyhsd()` |
| Bonferroni | `pairwise.t.test(..., p.adjust="bonferroni")` | `multipletests(method='bonferroni')` |
| Holm | `pairwise.t.test(..., p.adjust="holm")` | `multipletests(method='holm')` |
| Dunn Test | `FSA::dunnTest()` | `scikit_posthocs.posthoc_dunn()` |
| Games-Howell | `userfriendlyscience::oneway()` | `scikit_posthocs.posthoc_gameshowell()` |

### Quick Start Code

**R Example:**

```r
Load required libraries
library(multcomp)
library(FSA)

Assume ANOVA already performed
anova_model <- aov(response ~ group, data = data)

Tukey HSD (equal variances)
tukey_result <- TukeyHSD(anova_model)
print(tukey_result)

Bonferroni correction
pairwise.t.test(data$response, data$group, p.adjust.method = "bonferroni")

Dunn test (after Kruskal-Wallis)
dunnTest(response ~ group, data = data, method = "bonferroni")
```

**Python Example:**
```python
from statsmodels.stats.multicomp import pairwise_tukeyhsd
from statsmodels.stats.multitest import multipletests
import scikit_posthocs as sp

Tukey HSD (after ANOVA)
tukey = pairwise_tukeyhsd(df['response'], df['group'])
print(tukey)

Bonferroni: Manual pairwise tests
from scipy import stats
group_names = df['group'].unique()
p_values = []
comparisons = []

for i in range(len(group_names)):
for j in range(i+1, len(group_names)):
g1 = df[df['group'] == group_names[i]]['response']
g2 = df[df['group'] == group_names[j]]['response']
_, p = stats.ttest_ind(g1, g2)
p_values.append(p)
comparisons.append(f"{group_names[i]} vs {group_names[j]}")

Apply Bonferroni correction
rejected, p_adjusted, _, _ = multipletests(p_values, method='bonferroni')
results = pd.DataFrame({'Comparison': comparisons,
'P_adjusted': p_adjusted,
'Significant': rejected})
print(results)

Dunn test (after Kruskal-Wallis)
dunn_results = sp.posthoc_dunn(df, val_col='response',
group_col='group', p_adjust='bonferroni')
print(dunn_results)
```
