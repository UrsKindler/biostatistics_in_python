# False Discovery Rate Control

### Overview
- **Purpose**: Control false positives when performing multiple hypothesis tests
- **Use Case**: High-throughput data (genomics, proteomics), feature selection
- **Prerequisites**: Multiple p-values from independent or weakly dependent tests
- **Data Types**: P-values from any statistical test

### When to Use
#### Decision Criteria
- **Use always**: When testing >10 hypotheses simultaneously
- **Essential when**: Genomics, proteomics, metabolomics studies
- **Critical for**: Feature selection in high-dimensional data
- **Better than**: Bonferroni (less conservative, more power)

#### Data Type Requirements
- **Input**: Array of p-values from statistical tests
- **Sample Size**: Works with any number of tests (10 to 10,000+)
- **Independence**: Tests should be independent or weakly correlated
- **Not Suitable For**: <10 tests (use Bonferroni), fully dependent tests

### R vs Python

| Aspect | R | Python |
|--------|---|--------|
| Package | `base R`, `qvalue` | `statsmodels.stats.multitest` |
| Bonferroni | `p.adjust(method="bonferroni")` | `multipletests(method='bonferroni')` |
| Holm | `p.adjust(method="holm")` | `multipletests(method='holm')` |
| Benjamini-Hochberg | `p.adjust(method="BH")` | `multipletests(method='fdr_bh')` |
| Benjamini-Yekutieli | `p.adjust(method="BY")` | `multipletests(method='fdr_by')` |
| q-values | `qvalue::qvalue()` | Custom implementation |

### Quick Start Code

**R Example:**
```r
Assume p_values is a vector of p-values
Benjamini-Hochberg FDR (most common)
p_adjusted_bh <- p.adjust(p_values, method = "BH")

Bonferroni (conservative)
p_adjusted_bonf <- p.adjust(p_values, method = "bonferroni")

Count significant at alpha = 0.05
sum(p_adjusted_bh < 0.05)
sum(p_adjusted_bonf < 0.05)
```


**Python Example:**
```python
from statsmodels.stats.multitest import multipletests
import numpy as np

Assume p_values is array of p-values
alpha = 0.05

Benjamini-Hochberg FDR (standard for high-throughput)
reject_bh, p_bh, _, _ = multipletests(p_values, alpha=alpha, method='fdr_bh')
print(f"Significant features (FDR): {np.sum(reject_bh)}")

Bonferroni (very conservative)
reject_bonf, p_bonf, _, _ = multipletests(p_values, alpha=alpha, method='bonferroni')
print(f"Significant features (Bonferroni): {np.sum(reject_bonf)}")

Holm (less conservative than Bonferroni)
reject_holm, p_holm, _, _ = multipletests(p_values, alpha=alpha, method='holm')
print(f"Significant features (Holm): {np.sum(reject_holm)}")

Create results dataframe
results = pd.DataFrame({
'Feature': feature_names,
'P_value': p_values,
'P_adjusted_FDR': p_bh,
'Significant': reject_bh
}).sort_values('P_adjusted_FDR')

print(results.head(10))
```
